---
// Header.astro
const navItems = [
  { name: "Inicio", href: "#inicio" },
  { name: "Servicios", href: "#servicios" },
  { name: "Nosotros", href: "#nosotros" },
  { name: "Portfolio", href: "#portfolio" },
  { name: "IA", href: "#ia" },
  { name: "Contacto", href: "#contacto" },
];
---

<header
  id="header"
  class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 py-5 header-animate"
>
  <div
    class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between"
  >
    <!-- Logo -->
    <a href="#inicio" class="flex items-center gap-3 relative z-10">
      <div class="relative w-10 h-10">
        <div
          class="absolute inset-0 bg-linear-to-br from-[#00D6A1] to-[#ed1d85] rounded-lg transform rotate-12"
        >
        </div>
        <div
          class="absolute inset-1 bg-[#0a0b1a] rounded-md flex items-center justify-center"
        >
          <span
            class="font-heading font-bold text-xl text-[#00D6A1]"
            >P</span
          >
        </div>
      </div>
      <div class="hidden sm:block">
        <span class="font-heading font-semibold text-lg text-white"
          >Prismatica</span
        >
        <span class="block text-xs text-gray-400"
          >Software & Automation</span
        >
      </div>
    </a>

    <!-- Desktop Navigation -->
    <nav class="hidden lg:flex items-center gap-8">
      {
        navItems.map((item) => (
          <a
            href={item.href}
            class="text-sm font-medium text-gray-300 hover:text-[#00D6A1] transition-colors relative group"
          >
            {item.name}
            <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-[#00D6A1] transition-all duration-300 group-hover:w-full" />
          </a>
        ))
      }
    </nav>

    <!-- CTA Button -->
    <div class="hidden lg:block">
      <a
        href="#contacto"
        class="bg-[#00D6A1] hover:bg-[#00D6A1]/90 text-[#0a0b1a] font-bold px-6 py-2 rounded-lg transition-all duration-300 inline-block shadow-lg hover:shadow-[#00D6A1]/50"
      >
        Contáctanos
      </a>
    </div>

    <!-- Mobile Menu Button -->
    <button
      id="mobile-menu-button"
      class="lg:hidden p-2 text-white relative z-10"
      aria-label="Toggle menu"
    >
      <svg
        id="menu-icon"
        class="w-6 h-6"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>
      <svg
        id="close-icon"
        class="w-6 h-6 hidden"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
  </div>

  <!-- Mobile Menu -->
  <div
    id="mobile-menu"
    class="lg:hidden bg-white/5 backdrop-blur-xl border border-white/10 mt-3 mx-4 rounded-lg p-4 hidden opacity-0 transition-opacity duration-300"
  >
    <nav class="flex flex-col gap-4">
      {
        navItems.map((item) => (
          <a
            href={item.href}
            class="mobile-menu-link text-sm font-medium text-gray-300 hover:text-[#00D6A1] transition-colors"
          >
            {item.name}
          </a>
        ))
      }
      <a
        href="#contacto"
        class="bg-[#00D6A1] hover:bg-[#00D6A1]/90 text-[#0a0b1a] font-bold w-full mt-2 py-2 rounded-lg transition-colors text-center"
      >
        Contáctanos
      </a>
    </nav>
  </div>
</header>

<script>
  // Header initial animation
  const header = document.getElementById("header");
  if (header) {
    // Trigger animation on load
    setTimeout(() => {
      header.classList.add("show");
    }, 100);
  }

  // Header scroll effect
  let lastScrollY = window.scrollY;

  function handleScroll() {
    const scrollY = window.scrollY;

    if (scrollY > 50) {
      header?.classList.add("scrolled");
    } else {
      header?.classList.remove("scrolled");
    }

    lastScrollY = scrollY;
  }

  window.addEventListener("scroll", handleScroll);

  // Mobile menu toggle
  const mobileMenuButton = document.getElementById("mobile-menu-button");
  const mobileMenu = document.getElementById("mobile-menu");
  const menuIcon = document.getElementById("menu-icon");
  const closeIcon = document.getElementById("close-icon");
  const mobileMenuLinks = document.querySelectorAll(".mobile-menu-link");

  function toggleMobileMenu() {
    const isOpen = !mobileMenu?.classList.contains("hidden");

    if (isOpen) {
      mobileMenu?.classList.add("opacity-0");
      setTimeout(() => {
        mobileMenu?.classList.add("hidden");
      }, 300);
      menuIcon?.classList.remove("hidden");
      closeIcon?.classList.add("hidden");
    } else {
      mobileMenu?.classList.remove("hidden");
      setTimeout(() => {
        mobileMenu?.classList.remove("opacity-0");
      }, 10);
      menuIcon?.classList.add("hidden");
      closeIcon?.classList.remove("hidden");
    }
  }

  mobileMenuButton?.addEventListener("click", toggleMobileMenu);

  // Close mobile menu when clicking on a link
  mobileMenuLinks.forEach((link) => {
    link.addEventListener("click", () => {
      if (!mobileMenu?.classList.contains("hidden")) {
        toggleMobileMenu();
      }
    });
  });
</script>

<style>
  /* Header initial state - solid background */
  #header {
    background: #0a0b1a;
    border-bottom: 1px solid transparent;
  }

  /* Header initial animation */
  .header-animate {
    transform: translateY(-100px);
    transition: 
      transform 0.6s ease-out,
      background 0.3s ease,
      border-color 0.3s ease,
      backdrop-filter 0.3s ease;
  }

  .header-animate.show {
    transform: translateY(0);
  }

  /* Scrolled state - add transparency and blur */
  #header.scrolled {
    background: rgba(10, 11, 26, 0.8);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding-top: 0.75rem;
    padding-bottom: 0.75rem;
  }
</style>